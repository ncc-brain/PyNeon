
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Resample Data and Concatenate Channels &#8212; PyNeon dev documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=3ce10a4d"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/resample_and_concat';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Mapping Scanpath to video" href="video.html" />
    <link rel="prev" title="Reading a Neon dataset/recording" href="read_recording.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">PyNeon dev documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../reference/index.html">
    API reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NCCLabMPI/PyNeon" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../reference/index.html">
    API reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NCCLabMPI/PyNeon" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="read_recording.html">Reading a Neon dataset/recording</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Resample Data and Concatenate Channels</a></li>
<li class="toctree-l1"><a class="reference internal" href="video.html">Mapping Scanpath to video</a></li>
<li class="toctree-l1"><a class="reference internal" href="export_to_bids.html">Export Neon data recording to BIDS formats</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">PyNeon Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Resample...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="Resample-Data-and-Concatenate-Channels">
<h1>Resample Data and Concatenate Channels<a class="headerlink" href="#Resample-Data-and-Concatenate-Channels" title="Link to this heading">#</a></h1>
<p>Informative as it is, raw Neon data is not always easy to work with. Different data streams (e.g., gaze, eye states, IMU) are sampled at different rates, don’t necessarily share a common start timestamp, and within each stream data might not have been sampled at a constant rate. This tutorial demonstrates how to deal with these issues by resampling data streams and concatenating them into a single DataFrame.</p>
<p>We will use the same <code class="docutils literal notranslate"><span class="pre">OfficeWalk</span></code> dataset as in the <a class="reference internal" href="read_recording.html"><span class="doc">previous tutorial</span></a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy as np
from pyneon import get_sample_data, NeonRecording, time_to_ts

import matplotlib.pyplot as plt

recording_dir = get_sample_data(&quot;OfficeWalk&quot;) / &quot;Timeseries Data&quot; / &quot;walk1-e116e606&quot;
</pre></div>
</div>
</div>
<p>We can now access raw data from gaze, eye states, and IMU streams.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>recording = NeonRecording(recording_dir)
gaze = recording.gaze
eye_states = recording.eye_states
imu = recording.imu
</pre></div>
</div>
</div>
<section id="Unequally-sampled-data">
<h2>Unequally sampled data<a class="headerlink" href="#Unequally-sampled-data" title="Link to this heading">#</a></h2>
<p>Data from each stream has <code class="docutils literal notranslate"><span class="pre">timestamp</span> <span class="pre">[ns]</span></code> and <code class="docutils literal notranslate"><span class="pre">time</span> <span class="pre">[s]</span></code> columns, which denotes the UTC time of the sample in nanoseconds and the relative time since stream onset in seconds, respectively. But are they equally spaced in time? Let’s explore that by computing the time differences between consecutive samples for each stream and check how many unique values we have. If the data was sampled at a constant rate, we should have only one unique value.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Get the data points
gaze_ts = gaze.data[&quot;timestamp [ns]&quot;].values
eye_states_ts = eye_states.data[&quot;timestamp [ns]&quot;].values
imu_ts = imu.data[&quot;timestamp [ns]&quot;].values

# Calculate the distances between subsequent data points
gaze_diff = np.diff(gaze_ts)
eye_states_diff = np.diff(eye_states_ts)
imu_diff = np.diff(imu_ts)

# Unique values
gaze_diff_unique = np.unique(gaze_diff)
eye_states_diff_unique = np.unique(eye_states_diff)
imu_diff_unique = np.unique(imu_diff)

print(
    f&quot;Unique gaze time differences: {len(gaze_diff_unique)}, max: {np.max(gaze_diff_unique)/1e6}ms&quot;
)
print(
    f&quot;Unique eye states time differences: {len(eye_states_diff_unique)}, max: {np.max(eye_states_diff_unique)/1e6}ms&quot;
)
print(
    f&quot;Unique imu time differences: {len(imu_diff_unique)}, max: {np.max(imu_diff_unique)/1e6}ms&quot;
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Unique gaze time differences: 130, max: 115.123ms
Unique eye states time differences: 130, max: 115.123ms
Unique imu time differences: 1106, max: 230.444ms
</pre></div></div>
</div>
<p>Oops, it seems the data are far from being continuously sampled. We can further explore the distribution of such differences by plotting a histogram.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>gaze_nominal_diff = 1e9 / gaze.sampling_freq_nominal
eye_states_nominal_diff = 1e9 / eye_states.sampling_freq_nominal
imu_nominal_diff = 1e9 / imu.sampling_freq_nominal

fig, axs = plt.subplots(3, 1, tight_layout=True)

axs[0].hist(gaze_diff, bins=50)
axs[0].axvline(gaze_nominal_diff, color=&quot;red&quot;, label=&quot;Nominal&quot;)
axs[0].set_title(&quot;Gaze&quot;)

axs[1].hist(eye_states_diff, bins=50)
axs[1].axvline(eye_states_nominal_diff, color=&quot;red&quot;, label=&quot;Nominal&quot;)
axs[1].set_title(&quot;Eye states&quot;)

axs[2].hist(imu_diff, bins=50)
axs[2].axvline(imu_nominal_diff, color=&quot;red&quot;, label=&quot;Nominal&quot;)
axs[2].set_title(&quot;IMU&quot;)

for i in range(3):
    axs[i].set_yscale(&quot;log&quot;)
    axs[i].set_xlabel(&quot;Time difference [ns]&quot;)
    axs[i].set_ylabel(&quot;Counts&quot;)
    axs[i].legend()
plt.show()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_resample_and_concat_7_0.png" src="../_images/tutorials_resample_and_concat_7_0.png" />
</div>
</div>
</section>
<section id="Resampling-data-streams">
<h2>Resampling data streams<a class="headerlink" href="#Resampling-data-streams" title="Link to this heading">#</a></h2>
<p>Given the unequal sampling, if we want to obtain continuous data streams, interpolation is necessary. PyNeon uses the <code class="docutils literal notranslate"><span class="pre">scipy.interpolate.interp1d</span></code> function to interpolate data streams. We can resample each stream by simply calling <code class="docutils literal notranslate"><span class="pre">resample()</span></code> which returns a new DataFrame with the resampled data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Resample to the nominal sampling frequency
gaze_resampled_data = gaze.interpolate()
print(gaze_resampled_data.head())

ts = gaze_resampled_data[&quot;timestamp [ns]&quot;].values
ts_diffs = np.diff(ts)
ts_diff_unique = np.unique(ts_diffs)
print(f&quot;Only one unique time difference: {np.unique(ts_diffs)}&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
        timestamp [ns]  time [s]  gaze x [px]  gaze y [px]  worn  fixation id  \
0  1725032224852161732     0.000  1067.486000   620.856000  True            1
1  1725032224857161732     0.005  1066.920463   617.120061  True            1
2  1725032224862161732     0.010  1072.699000   615.780000  True            1
3  1725032224867161732     0.015  1067.447000   617.062000  True            1
4  1725032224872161732     0.020  1071.564000   613.158000  True            1

   blink id  azimuth [deg]  elevation [deg]
0      &lt;NA&gt;      16.213030        -0.748998
1      &lt;NA&gt;      16.176315        -0.511927
2      &lt;NA&gt;      16.546413        -0.426618
3      &lt;NA&gt;      16.210049        -0.508251
4      &lt;NA&gt;      16.473521        -0.260388
Only one unique time difference: [5000000]
</pre></div></div>
</div>
<p>In the above example, we resampled the gaze data with default parameters, which means that the resampled data will have the same start and timestamps as the original data, and the sampling rate is set to the nominal sampling frequency (200 Hz, as specified by Pupil Labs). Notice that resampling would not change the data type of the columns. For example, the <code class="docutils literal notranslate"><span class="pre">bool</span></code>-type <code class="docutils literal notranslate"><span class="pre">worn</span></code> column and the integer-type <code class="docutils literal notranslate"><span class="pre">fixation_id</span></code> column are preserved.</p>
<p>Alternatively, one can also resample the gaze data to any desired timestamps by specifying the <code class="docutils literal notranslate"><span class="pre">new_ts</span></code> parameter. This is especially helpful when synchronizing different data streams. For example, we can resample the gaze data (~200Hz) to the timestamps of the IMU data (~110Hz).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(f&quot;Original gaze data length: {gaze.data.shape[0]}&quot;)
print(f&quot;Original IMU data length: {imu.data.shape[0]}&quot;)
gaze_resampled_to_imu_data = gaze.interpolate(new_ts=imu.ts)
print(f&quot;Data length after resampling to IMU: {gaze_resampled_to_imu_data.shape[0]}&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Original gaze data length: 18769
Original IMU data length: 10919
Data length after resampling to IMU: 10919
</pre></div></div>
</div>
</section>
<section id="Concatenating-different-streams">
<h2>Concatenating different streams<a class="headerlink" href="#Concatenating-different-streams" title="Link to this heading">#</a></h2>
<p>Based on the resampling method, it is then possible to concatenate different streams into a single DataFrame by resampling them to common timestamps. The method <code class="docutils literal notranslate"><span class="pre">concat_streams()</span></code> provides such functionality. It takes a list of stream names and resamples them to common timestamps, defined by the latest start and earliest end timestamps of the streams. The news ampling frequency can either be directly specified or taken from the lowest/highest sampling frequency of the streams.</p>
<p>In the following example, we will concatenate the gaze, eye states, and IMU streams into a single DataFrame using the default parameters (e.g., using the lowest sampling frequency of the streams).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>concat_data = recording.concat_streams([&quot;gaze&quot;, &quot;eye_states&quot;, &quot;imu&quot;])
print(concat_data.head())
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Concatenating streams:
        Gaze
        3D eye states
        IMU
Using lowest sampling rate: 110 Hz ([&#39;imu&#39;])
Using latest start timestamp: 1725032224878547732 ([&#39;imu&#39;])
Using earliest last timestamp: 1725032319533909732 ([&#39;imu&#39;])
        timestamp [ns]  time [s]  gaze x [px]  gaze y [px]  worn  fixation id  \
0  1725032224878547732  0.000000  1073.410354   611.095861  True            1
1  1725032224887638641  0.009091  1069.801082   613.382535  True            1
2  1725032224896729550  0.018182  1070.090109   613.439696  True            1
3  1725032224905820459  0.027273  1069.891351   612.921757  True            1
4  1725032224914911368  0.036364  1069.692588   612.403803  True            1

   blink id  azimuth [deg]  elevation [deg]  pupil diameter left [mm]  ...  \
0      &lt;NA&gt;      16.591703        -0.129540                  5.036588  ...
1      &lt;NA&gt;      16.360605        -0.274666                  5.093205  ...
2      &lt;NA&gt;      16.379116        -0.278283                  5.078107  ...
3      &lt;NA&gt;      16.366379        -0.245426                  5.077680  ...
4      &lt;NA&gt;      16.353641        -0.212567                  5.077253  ...

   acceleration x [g]  acceleration y [g]  acceleration z [g]  roll [deg]  \
0            0.063477           -0.058594            0.940430   -2.550682
1            0.057486           -0.048916            0.942273   -2.602498
2            0.051494           -0.039238            0.944117   -2.654314
3            0.046721           -0.045800            0.944336   -2.699777
4            0.042113           -0.054556            0.944336   -2.744383

   pitch [deg]   yaw [deg]  quaternion w  quaternion x  quaternion y  \
0    -4.461626 -172.335180      0.067636     -0.024792      0.037342
1    -4.493445 -172.562393      0.065682     -0.025185      0.037639
2    -4.525265 -172.789613      0.063728     -0.025579      0.037936
3    -4.556964 -173.013398      0.061802     -0.025917      0.038238
4    -4.588647 -173.236726      0.059879     -0.026247      0.038541

   quaternion z
0     -0.996703
1     -0.996810
2     -0.996917
3     -0.997017
4     -0.997115

[5 rows x 36 columns]
</pre></div></div>
</div>
<p>We show an exemplary sampling of eye, imu and concatenated data below. It can be seen that imu data has subsequent missing values which can in turn be interpolated</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>start_time = 5
end_time = 5.3
start_ts = time_to_ts(start_time, concat_data)
end_ts = time_to_ts(end_time, concat_data)

raw_gaze_data_slice = gaze.data[
    (gaze.data[&quot;timestamp [ns]&quot;] &gt;= start_ts) &amp; (gaze.data[&quot;timestamp [ns]&quot;] &lt;= end_ts)
]
raw_eye_states_data_slice = eye_states.data[
    (eye_states.data[&quot;timestamp [ns]&quot;] &gt; start_ts)
    &amp; (eye_states.data[&quot;timestamp [ns]&quot;] &lt;= end_ts)
]
raw_imu_data_slice = imu.data[
    (imu.data[&quot;timestamp [ns]&quot;] &gt;= start_ts) &amp; (imu.data[&quot;timestamp [ns]&quot;] &lt;= end_ts)
]
concat_data_slice = concat_data[
    (concat_data[&quot;timestamp [ns]&quot;] &gt;= start_ts)
    &amp; (concat_data[&quot;timestamp [ns]&quot;] &lt;= end_ts)
]

# plot all data in the same scatter plot
plt.figure(figsize=(15, 4))
plt.scatter(
    raw_gaze_data_slice[&quot;timestamp [ns]&quot;],
    np.zeros_like(raw_gaze_data_slice[&quot;timestamp [ns]&quot;]) + 2,
    label=&quot;Raw gaze data&quot;,
    color=&quot;red&quot;,
)
plt.scatter(
    raw_eye_states_data_slice[&quot;timestamp [ns]&quot;],
    np.zeros_like(raw_eye_states_data_slice[&quot;timestamp [ns]&quot;]) + 1,
    label=&quot;Raw eye states data&quot;,
    color=&quot;orange&quot;,
)
plt.scatter(
    raw_imu_data_slice[&quot;timestamp [ns]&quot;],
    np.zeros_like(raw_imu_data_slice[&quot;timestamp [ns]&quot;]),
    label=&quot;Raw IMU data&quot;,
    color=&quot;blue&quot;,
)
plt.scatter(
    concat_data_slice[&quot;timestamp [ns]&quot;],
    np.zeros_like(concat_data_slice[&quot;timestamp [ns]&quot;]) - 1,
    label=&quot;Concatenated data&quot;,
    color=&quot;green&quot;,
)
# set x-ticks with higher frequency and add gridlines
plt.xticks(concat_data_slice[&quot;timestamp [ns]&quot;], labels=None)
plt.yticks([])
plt.grid()
plt.legend()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x1fb49a7bb60&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_resample_and_concat_15_1.png" src="../_images/tutorials_resample_and_concat_15_1.png" />
</div>
</div>
<p>A linear interpolation allows us to estimate missing values. In the end, the concatenated dataframe combines all continuous data into one central location</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># plot imu data and interpolated data in same plot
plt.figure(figsize=(16, 3))
plt.scatter(
    raw_imu_data_slice[&quot;time [s]&quot;],
    raw_imu_data_slice[&quot;acceleration z [g]&quot;],
    label=&quot;Raw imu data&quot;,
    color=&quot;blue&quot;,
)
plt.plot(
    concat_data_slice[&quot;time [s]&quot;],
    concat_data_slice[&quot;acceleration z [g]&quot;],
    label=&quot;Interpolated imu data&quot;,
    color=&quot;green&quot;,
)
plt.legend()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x1fb49cd3d10&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_resample_and_concat_17_1.png" src="../_images/tutorials_resample_and_concat_17_1.png" />
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="read_recording.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Reading a Neon dataset/recording</p>
      </div>
    </a>
    <a class="right-next"
       href="video.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Mapping Scanpath to video</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Unequally-sampled-data">Unequally sampled data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Resampling-data-streams">Resampling data streams</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Concatenating-different-streams">Concatenating different streams</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/tutorials/resample_and_concat.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, PyNeon developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>